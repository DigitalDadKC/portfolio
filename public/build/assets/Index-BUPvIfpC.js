import{A,c as _,o as m,d as t,z as V,b as n,y as R,g as y,l as H,v as N,a as f,B as K,C as F,F as j,r as D,t as d,D as G,E as Q,s as W,G as X,H as J,f as O,j as Z,w as z,h as ee,e as $,k as te}from"./app-B36-XCD0.js";import{_ as se}from"./TextInput-BUqMx1B9.js";import{_ as U}from"./InputLabel-CCUe8WEK.js";import{_ as L,a as ae}from"./Links-BKi0eCa8.js";import{u as Y}from"./useFormatCurrency-C2nvWDUD.js";import{_ as oe}from"./GuestLayout-C970xYKx.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const le={class:"relative"},ie={class:"mt-10 overflow-hidden py-2"},re={__name:"Sidebar",emits:["showSideBar"],setup(x,{emit:w}){const o=A("my-flag",!1),v=w,c=()=>{o.value=!o.value,v("showSideBar",o.value)};return(p,h)=>(m(),_("aside",{class:V(["absolute lg:static bg-light-quatrenary min-h-screen transition-all duration-500 ease-in-out",{"w-screen sm:w-72 border-r":n(o),"w-0":!n(o)}])},[t("div",le,[t("button",{class:V(["fixed transition-all duration-500 ease-in-out rounded-l-none rounded-r-md z-10 mt-16",{"rotate-90 bg-dark-quatrenary ml-72 rounded-br-none rounded-tl-md":n(o),"bg-dark-tertiary":!n(o)}]),onClick:h[0]||(h[0]=k=>c())},h[1]||(h[1]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-12 h-12 dark:text-white"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"})],-1)]),2)]),t("div",ie,[R(p.$slots,"sidebarContents")])],2))}},ne={class:"rounded-md w-full rounded-md truncate"},de={class:"text-sm bg-white rounded-md p-2"},ce={class:"flex items-start justify-start"},ue=["id","checked"],fe=["for"],me=["id","value","onUpdate:modelValue","checked"],ve=["for"],P={__name:"SidebarFilter",props:{name:{type:String,required:!0},list:{type:Object,required:!0},category:{type:String},items:{type:Object}},emits:["update:list"],setup(x,{emit:w}){const o=x,v=y(!0),c=y({});c.value=o.items;const p=o.name+"-filter",h=w;H(()=>o.list,()=>{v.value=o.list.every(i=>i.checked),c.value.forEach(i=>{i.filters[p]=o.list.filter(r=>r.checked).map(r=>r.Name).includes(i[o.category])}),h("update:list",c.value)},{deep:!0});const k=i=>{let r=o.list.find(u=>o.name+"-"+u.id==i);r.checked=!r.checked},g=()=>{o.list.every(i=>i.checked)?o.list.map(i=>i.checked=!1):o.list.map(i=>i.checked=!0)};return N(()=>{o.list.forEach(i=>{i.checked=!0,i.category=o.name,i.count=c.value.filter(r=>i.Name==r[o.category]).length}),c.value.forEach(i=>{i.filters[p]=!0})}),(i,r)=>(m(),_("div",ne,[f(U,{for:o.name,value:o.name,class:"text-gray-900 text-xl text-light-primary"},null,8,["for","value"]),t("ul",de,[t("li",ce,[K(t("input",{id:`${o.name}-select-all`,type:"checkbox",onClick:r[0]||(r[0]=u=>g(o.name)),class:"bg-gray-100 border-gray-300 rounded-md text-sm mr-2",checked:v.value,"onUpdate:modelValue":r[1]||(r[1]=u=>v.value=u)},null,8,ue),[[F,v.value]]),t("label",{for:`${o.name}-select-all`,class:"text-start"},"SELECT ALL",8,fe)]),(m(!0),_(j,null,D(o.list,(u,S)=>(m(),_("li",{key:S,class:"flex items-start justify-start"},[K(t("input",{id:`${o.name}-filter_option_${S}`,type:"checkbox",value:o.name+"-"+u.id,"onUpdate:modelValue":C=>u.checked=C,checked:u.checked,class:"bg-gray-100 border-gray-300 rounded text-sm mr-2",onInput:r[2]||(r[2]=C=>k(C.target.value))},null,40,me),[[F,u.checked]]),t("label",{for:`${o.name}-filter_option_${S}`,class:"text-start mr-2"},d(u.Name),9,ve),t("label",null,"("+d(u.count)+")",1)]))),128))])]))}},pe={class:"inline-flex w-full text-white justify-between"},_e=["value","min","max","step"],he={__name:"Slider",props:{min:{type:Number,default:0},max:{type:Number,default:100},step:{type:Number,default:1},modelValue:{type:Number,default:50}},emits:["update:modelValue"],setup(x,{emit:w}){const{formatCurrency:o}=Y(),v=w;let c=y(x.modelValue);const p=y(null),h=(g,i,r)=>(g-i)/(r-i)*100,k=g=>{p.value.style.setProperty("--ProgressPercent",`${g}%`)};return G(()=>{if(p.value){v("update:modelValue",c.value);const g=h(c.value,p.value.min,p.value.max);let i=(100-g)/10;k(g+i)}}),N(()=>{c.value=x.max}),(g,i)=>(m(),_("div",pe,[t("input",{ref_key:"slider",ref:p,value:n(c),onInput:i[0]||(i[0]=({target:r})=>Q(c)?c.value=parseFloat(r.value):c=parseFloat(r.value)),type:"range",min:x.min,max:x.max,step:x.step,class:"appearance-none bg-light-secondary rounded-md w-48 accent-light-quatrenary"},null,40,_e),t("span",null,d(n(o)(n(c))),1)]))}},ge={class:"flex"},xe={class:"px-4 flex flex-col justify-start items-start justify-between"},ye={class:"truncate text-md text-white"},we={class:"px-4 md:py-2"},be={class:"px-4 md:py-2"},ke={class:"px-4 md:py-2"},Se={class:"px-4 md:py-2"},Ce={class:"px-4 md:py-2"},$e={class:"px-4 md:py-2 mt-4"},Ue=["href"],Me={class:"container mx-auto"},Pe={class:"w-full"},Ve={class:"text-white flex justify-center"},je={class:"sm:hidden text-sm"},De={class:"flex justify-between"},Ne={class:"flex justify-between text-nowrap"},Ee={key:0,class:"whitespace-nowrap"},Be={class:"hidden sm:flex text-sm md:text-base bg-light-tertiary"},Ke={class:"table-auto w-full text-white uppercase text-left"},Fe={class:"bg-black text-white"},Oe={class:"flex md:px-4"},ze={class:"flex-inline"},Le={key:0,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"3.5",stroke:"currentColor",class:"w-4 h-4 inline"},Ye={key:1,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"3.5",stroke:"currentColor",class:"w-4 h-4 inline"},Ie={key:2,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"3.5",stroke:"currentColor",class:"w-4 h-4 inline"},qe={class:"divide-y divide-light-tail-100"},Te={class:"w-1/12"},Ae={class:"w-1/3 text-wrap"},Re={class:"w-1/12 hidden lg:table-cell"},He={class:"w-1/6"},Ge={class:"whitespace-nowrap"},Qe={key:0,class:"whitespace-nowrap"},We={class:"w-1/6"},Xe={class:"w-1/12"},Je={class:"w-1/12"},it={__name:"Index",props:{materials:Object,contracts:Object,data:Object,categories:Object,book_price_effective_dates:Object,statuses:Object,discountables:Object},setup(x){const{formatCurrency:w}=Y(),o=x,v=y([]);v.value=o.materials,v.value.forEach(l=>l.filters={});const c=y(0),p=y([]);y(10);const h=y(1),k=y(!1),g=y(0),i=W(()=>{let l=o.materials;return l=l.filter(e=>!Object.values(e.filters).includes(!1)),l=l.filter(e=>e[s.effective_date]<s.price),s.search!==null&&(l=l.filter(e=>e.Name.toLowerCase().includes(s.search.toLowerCase().trim())||e.SKU.toLowerCase().includes(s.search.toLowerCase().trim()))),s.categories.forEach(e=>e.count=l.filter(a=>a.material_category.Name==e.Name).length),s.statuses.forEach(e=>{e.count=l.filter(a=>a[s.status]==e.Name).length}),s.discountables.forEach(e=>{e.count=l.filter(a=>a.Discountable==e.Name).length}),s.sortSKU&&(s.sortMethod=="asc"?l.sort((e,a)=>e.SKU.localeCompare(a.SKU)):l.sort((e,a)=>a.SKU.localeCompare(e.SKU))),l}),{currentPage:r,currentPageSize:u,isFirstPage:S,isLastPage:C}=J({total:o.materials.length,page:1,pageSize:10,onPageChange:b,onPageSizeChange:b}),s=X({search:"",contract:0,effective_date_id:o.book_price_effective_dates[0].id,effective_date:o.book_price_effective_dates[0].effective_date,status:"",effective_dates:o.book_price_effective_dates,reference_date:[],categories:o.categories,statuses:o.statuses,discountables:o.discountables,price_min:0,price:1e4,price_max:Math.max(...o.materials.map(l=>l[o.book_price_effective_dates[0].effective_date])),sortSKU:!1,sortMethod:""});s.status=s.effective_date+"-status";function b(){const l=(r.value-1)*u.value,e=l+u.value;return p.value=i.value.slice(l,e),h.value=Math.ceil(i.value.length/u.value),h.value<r.value&&(r.value=h.value),c.value=i.value.length,i.value.slice(l,e)}b();const I=()=>{s.sortSKU=!0,s.sortMethod=s.sortMethod=="asc"?"desc":"asc",b()};s.effective_dates.forEach(l=>l.display_date=O(l.effective_date,"MMMM D, YYYY").value);const E=(l,e)=>{const a=e+"-status";return l.Discountable?+l[e]*(1-+g.value):!l[e]&&l[a]?"QUOTE":+l[e]},B=(l,e)=>{const a=e+"-status";return l[a]},q=()=>{var l;s.effective_dates=+s.contract?o.contracts.filter(e=>e.id===+s.contract)[0].effective_dates:o.book_price_effective_dates,s.effective_dates.forEach(e=>e.display_date=O(e.effective_date,"MMMM D, YYYY").value),s.effective_date_id=+s.effective_dates[0].id,s.effective_date=s.effective_dates[0].effective_date,g.value=+s.contract?+((l=o.contracts.filter(e=>e.id===+s.contract)[0])==null?void 0:l.discount):0},T=()=>{var l,e;s.effective_date=((e=(l=o.contracts.filter(a=>a.id===+s.contract)[0])==null?void 0:l.effective_dates.filter(a=>a.id===+s.effective_date_id)[0])==null?void 0:e.effective_date)??o.book_price_effective_dates.filter(a=>a.id===+s.effective_date_id)[0].effective_date,s.status=s.effective_date+"-status"};return N(()=>{o.materials.forEach(l=>l.category=l.material_category.Name)}),(l,e)=>(m(),Z(oe,null,{default:z(()=>[t("div",ge,[f(n(ee),{title:"Datatable"}),f(re,{onShowSideBar:e[9]||(e[9]=a=>k.value=a)},{sidebarContents:z(()=>[t("div",xe,[t("div",null,[f(U,{for:"contractFilter",value:"Contracts",class:"text-xl text-light-primary"}),f(L,{modelValue:s.contract,"onUpdate:modelValue":e[0]||(e[0]=a=>s.contract=a),options:x.contracts,column:"name",initial:"Initial",id:"contractFilter",onChange:e[1]||(e[1]=a=>q())},null,8,["modelValue","options"])]),t("p",ye,"Contract Discount: "+d((g.value*100).toFixed(2))+"%",1)]),t("div",we,[f(U,{for:"effectiveDateFilter",value:"Effective Date",class:"text-gray-900 text-xl text-light-primary truncate"}),f(L,{modelValue:s.effective_date_id,"onUpdate:modelValue":e[2]||(e[2]=a=>s.effective_date_id=a),modelModifiers:{number:!0},options:s.effective_dates,column:"display_date",onChange:e[3]||(e[3]=a=>T())},null,8,["modelValue","options"])]),t("div",be,[f(U,{for:"price",value:"Price",class:"text-gray-900 text-xl text-light-primary truncate"}),f(he,{min:0,max:1e4,step:50,modelValue:s.price,"onUpdate:modelValue":e[4]||(e[4]=a=>s.price=a),onInput:e[5]||(e[5]=a=>b())},null,8,["modelValue"])]),t("div",ke,[f(P,{list:s.statuses,name:"Status",category:s.status,items:v.value,"onUpdate:list":e[6]||(e[6]=a=>b())},null,8,["list","category","items"])]),t("div",Se,[f(P,{list:s.discountables,name:"Discountable",category:"Discountable",items:v.value,"onUpdate:list":e[7]||(e[7]=a=>b())},null,8,["list","items"])]),t("div",Ce,[f(P,{list:s.categories,name:"Category",category:"category",items:v.value,"onUpdate:list":e[8]||(e[8]=a=>b())},null,8,["list","items"])]),t("div",$e,[t("a",{href:l.route("export",{data:s}),class:"px-4 py-2 bg-accent border border-black rounded-md text-black hover:text-light-primary hover:bg-light-tertiary"},"EXPORT",8,Ue)])]),_:1}),t("div",{class:V(["flex-1 bg-dark-primary md:px-4 py-16 px-4 h-screen",{"overflow-hidden md:overflow-y-auto md:block":k.value,"overflow-auto":!k.value}])},[t("div",Me,[t("div",Pe,[f(U,{for:"search",value:"Search",class:"dark:text-gray-900 text-xl text-light-primary"}),f(se,{modelValue:s.search,"onUpdate:modelValue":e[10]||(e[10]=a=>s.search=a),type:"text",class:"rounded-md w-full text-xl",required:"",autofocus:"",placeholder:"Search items...",id:"search",onInput:e[11]||(e[11]=a=>b())},null,8,["modelValue"])]),f(ae,{pages:h.value,isFirstPage:n(S),isLastPage:n(C),currentPage:n(r),currentPageSize:n(u),onChangePage:e[12]||(e[12]=a=>r.value=a),onChangeRecords:e[13]||(e[13]=a=>u.value=a)},null,8,["pages","isFirstPage","isLastPage","currentPage","currentPageSize"]),t("div",Ve," Showing "+d(n(u)*n(r)-(n(u)-1))+" - "+d(n(u)*n(r)<c.value?n(u)*n(r):c.value)+" Items ("+d(c.value)+" Total Items) ",1)]),t("div",je,[(m(!0),_(j,null,D(p.value,(a,M)=>(m(),_("div",{key:M,class:"flex flex-col border-b"},[t("div",De,[t("div",null,d(a.SKU)+" "+d(a.Name)+" ("+d(a.material_unit_size.Unit_Size)+") ",1),t("div",null,[t("span",null,"Book: "+d(n(w)(a[s.effective_date])),1)])]),t("div",Ne,[t("div",null,d(a.material_category.Name),1),t("div",null,[a.Discountable&&s.contract?(m(),_("span",Ee,"Discounted: "+d(n(w)(E(a,s.effective_date))),1)):$("",!0)])]),t("div",null,d(B(a,s.effective_date)),1)]))),128))]),t("div",Be,[t("table",Ke,[t("thead",Fe,[t("tr",Oe,[t("th",{class:"w-1/12",onClick:e[14]||(e[14]=a=>I())},[t("span",ze,[e[18]||(e[18]=te(" SKU ",-1)),s.sortSKU?$("",!0):(m(),_("svg",Le,e[15]||(e[15]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M17.25 8.25 21 12m0 0-3.75 3.75M21 12H3"},null,-1)]))),s.sortSKU&&s.sortMethod=="desc"?(m(),_("svg",Ye,e[16]||(e[16]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19.5 13.5 12 21m0 0-7.5-7.5M12 21V3"},null,-1)]))):$("",!0),s.sortSKU&&s.sortMethod=="asc"?(m(),_("svg",Ie,e[17]||(e[17]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M4.5 10.5 12 3m0 0 7.5 7.5M12 3v18"},null,-1)]))):$("",!0)])]),e[19]||(e[19]=t("th",{class:"w-1/3"},"Description",-1)),e[20]||(e[20]=t("th",{class:"w-1/12 hidden lg:table-cell"},"Unit",-1)),e[21]||(e[21]=t("th",{class:"w-1/6"},"Price",-1)),e[22]||(e[22]=t("th",{class:"w-1/6"},"Status",-1)),e[23]||(e[23]=t("th",{class:"w-1/12"},"Disc?",-1)),e[24]||(e[24]=t("th",{class:"w-1/12"},"Category",-1))])]),t("tbody",qe,[(m(!0),_(j,null,D(p.value,(a,M)=>(m(),_("tr",{key:M,class:"flex md:px-4 truncate"},[t("td",Te,d(a.SKU),1),t("td",Ae,d(a.Name),1),t("td",Re,d(a.material_unit_size.Unit_Size),1),t("td",He,[t("p",Ge,"Book: "+d(n(w)(a[s.effective_date])),1),a.Discountable&&s.contract?(m(),_("p",Qe,"Discounted: "+d(n(w)(E(a,s.effective_date))),1)):$("",!0)]),t("td",We,d(B(a,s.effective_date)),1),t("td",Xe,d(a.Discountable?"YES":"NO"),1),t("td",Je,d(a.material_category.Name),1)]))),128))])])])],2)])]),_:1}))}};export{it as default};
