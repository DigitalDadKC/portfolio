import{c as p,o as m,r as V,j as Y,z as q,I as U,F as v,g as h,s as j,i as k,a as l,b as c,h as A,w as a,d as t,p as b,k as r,t as n,f as I,q as J}from"./app-B36-XCD0.js";import{_ as M}from"./EstimatingLayout-D_4DmskC.js";import{P as D}from"./PrimaryButton-CEhAluKe.js";import{_ as P}from"./SecondaryButton-BY0miM6g.js";import"./NavLink-BrQt31dZ.js";import"./GuestLayout-C970xYKx.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const H={__name:"Paginator",props:{links:Object},setup(y){const o=y;return(f,_)=>(m(!0),p(v,null,V(o.links,d=>(m(),Y(U(d.url?"Link":"span"),{href:d.url,innerHTML:d.label,class:q(["bg-grey-lighten-2 rounded-md py-2 px-4",{"text-light-tertiary dark:text-dark-tertiary":!d.url,"font-bold text-light-secondary bg-light-quatrenary dark:bg-dark-quatrenary":d.active}]),prefetch:""},null,8,["href","innerHTML","class"]))),256))}},G={class:"flex justify-center"},K={class:"table table-auto bg-light-primary dark:bg-dark-primary rounded-lg"},Q={class:"uppercase"},R={colspan:"10"},W={class:"flex flex-col md:flex-row justify-between px-2 py-4"},X={class:"d-flex align-center ga-2"},Z={class:"uppercase font-weight-bold"},tt={class:"w-96 p-1"},et={class:"flex"},st={class:"p-1"},lt={class:"text-center hidden xl:table-cell"},at={class:"p-2"},rt={class:"flex items-center justify-between"},nt={class:"hidden xl:table-cell max-w-96"},ot={class:"bg-light-secondary w-1/2 px-2 py-1"},dt={class:"min-w-52"},it={class:"flex flex-col"},ut={class:"min-w-24"},mt={class:"min-w-24"},ct={CLASS:"min-w-28"},pt={class:"min-w-24"},ft={class:"min-w-24"},_t={class:"text-start"},gt={class:"flex justify-between py-1"},ht=["href"],bt=["href"],Et={__name:"Index",props:{jobs:Object,states:Object,customers:Object,filters:Object},setup(y){var C;const o=y,f=h(o.filters.search),_=h(((C=o.filters)==null?void 0:C.pages)??25),d=h(o.filters.state),x=h(o.filters.customer),S=j(()=>[{id:null,state:"SELECT"},...o.states]),L=j(()=>[{id:null,name:"SELECT"},...o.customers]),g=()=>{J.reload({data:{search:f.value,pages:_.value,state:d.value,customer:x.value},only:["jobs","filters"],replace:!0,preserveState:!0})};return(u,e)=>{const w=k("v-select"),T=k("v-text-field"),E=k("v-icon");return m(),p(v,null,[l(c(A),{title:"Estimating"}),l(M,null,{default:a(()=>[t("div",G,[t("table",K,[t("thead",null,[t("tr",Q,[t("th",R,[t("div",W,[l(c(b),{href:u.route("estimating.create"),as:"button",class:"",prefetch:""},{default:a(()=>[l(D,null,{default:a(()=>e[8]||(e[8]=[r("Add Job",-1)])),_:1,__:[8]})]),_:1},8,["href"]),t("div",X,[l(H,{links:o.jobs.meta.links},null,8,["links"])]),l(w,{density:"compact",modelValue:_.value,"onUpdate:modelValue":[e[0]||(e[0]=s=>_.value=s),e[1]||(e[1]=s=>g())],variant:"underlined","hide-details":"",label:"Pages",items:[{id:10},{id:25},{id:50}],"item-title":"id","item-value":"id",class:"d-flex align-center justify-center max-w-20 text-center bg-grey-lighten-2 rounded-md"},null,8,["modelValue"])])])]),t("tr",Z,[t("th",tt,[e[9]||(e[9]=r(" Job # ",-1)),t("div",et,[l(T,{density:"compact",modelValue:f.value,"onUpdate:modelValue":e[2]||(e[2]=s=>f.value=s),class:"w-full rounded-lg bg-light-secondary","hide-details":"",label:"Search job #, address, or city...","prepend-inner-icon":"mdi-magnify",onInput:e[3]||(e[3]=s=>g())},null,8,["modelValue"])])]),t("th",st,[e[10]||(e[10]=t("div",null,"Address",-1)),l(w,{density:"compact",modelValue:d.value,"onUpdate:modelValue":[e[4]||(e[4]=s=>d.value=s),e[5]||(e[5]=s=>g())],class:"min-w-40 bg-light-secondary",items:S.value,"item-title":"state","item-value":"id",label:"State","hide-details":""},null,8,["modelValue","items"])]),t("th",lt,[e[11]||(e[11]=r(" Customer ",-1)),l(w,{density:"compact",modelValue:x.value,"onUpdate:modelValue":[e[6]||(e[6]=s=>x.value=s),e[7]||(e[7]=s=>g())],class:"min-w-40 bg-light-secondary",items:L.value,"item-title":"name","item-value":"id",label:"Customer","hide-details":""},null,8,["modelValue","items"])]),e[12]||(e[12]=t("th",{class:"bg-light-secondary"},[t("div",{class:"text-center text-lg"}," Proposals "),t("table",{class:"table table-auto"},[t("tbody",null,[t("tr",null,[t("th",{class:"pl-2 w-52 text-start"},"Name"),t("th",{class:"w-24 text-start"},"Type"),t("th",{class:"w-24 text-start"},"Created"),t("th",{class:"w-28 text-start"},"Estimator"),t("th",{class:"w-24 text-start"},"Total"),t("th",{class:"w-20 text-start"},"Edit"),t("th",{class:"text-start"},"Export")])])])],-1))])]),t("tbody",null,[(m(!0),p(v,null,V(o.jobs.data,(s,F)=>(m(),p("tr",{key:F},[t("td",at,[t("div",rt,[r(n(`D${new Date(s.created_at).getFullYear()} - `+s.number)+" ",1),l(c(b),{href:u.route("estimating.edit",s.id),prefetch:""},{default:a(()=>[l(P,null,{default:a(()=>e[13]||(e[13]=[r("Edit",-1)])),_:1,__:[13]})]),_:2},1032,["href"])])]),t("td",null,[r(n(s.address),1),e[14]||(e[14]=t("br",null,null,-1)),r(n(s.city)+", "+n(s.state.state)+" "+n(s.zip),1)]),t("td",nt,n(s.customer.name),1),t("td",ot,[l(c(b),{method:"post",as:"button",href:u.route("proposals",{job:s.id})},{default:a(()=>[l(D,{class:"h-6"},{default:a(()=>e[15]||(e[15]=[r("New Proposal",-1)])),_:1,__:[15]})]),_:2},1032,["href"]),(m(!0),p(v,null,V(s.proposals,(i,z)=>(m(),p("tr",{key:z},[t("td",dt,[t("div",it,[t("div",null,n(i.name),1)])]),t("td",ut,n(i.type),1),t("td",mt,n(c(I)(i.created_at,"M/D/YYYY")),1),t("td",ct,n(i.estimator.name),1),t("td",pt,n(u.$filters.formatCurrency(i.scopes.reduce((B,N)=>B+N.lines.reduce((O,$)=>O+$.price*$.quantity*100/100,0),0))),1),t("td",ft,[l(c(b),{href:u.route("proposals.edit",{proposal:i.id})},{default:a(()=>[l(P,{class:"w-20 h-6 bg-accent text-accent"},{default:a(()=>e[16]||(e[16]=[r("Edit",-1)])),_:1,__:[16]})]),_:2},1032,["href"])]),t("td",_t,[t("div",gt,[t("a",{href:u.route("proposals.downloadPDF",{proposal:i.id})},[l(E,{size:"x-large",class:"text-accent"},{default:a(()=>e[17]||(e[17]=[r("mdi-download",-1)])),_:1,__:[17]})],8,ht),t("a",{target:"_blank",href:u.route("proposals.browserPDF",{proposal:i.id})},[l(E,{size:"x-large",class:"text-accent"},{default:a(()=>e[18]||(e[18]=[r("mdi-file-document-arrow-right",-1)])),_:1,__:[18]})],8,bt)])])]))),128))])]))),128))])])])]),_:1})],64)}}};export{Et as default};
