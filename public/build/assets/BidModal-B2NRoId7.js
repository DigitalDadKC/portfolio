import{j,o as F,w as I,d as b,y as C,g as N,aN as X,s as G,l as z,af as J,c as D,z as Z,t as R,u as H,x as w,k as K,a as v,b as S,F as A,r as T}from"./app-B36-XCD0.js";import{_ as Q}from"./Modal-BiCN6eYC.js";import{_ as V}from"./TextInput-BUqMx1B9.js";const Y={class:"px-6 py-4"},ee={class:"text-lg font-medium text-gray-900 dark:text-gray-100"},te={class:"mt-4 text-sm text-gray-600 dark:text-gray-400"},ie={class:"flex flex-row justify-end px-6 py-4 bg-gray-100 dark:bg-gray-800 text-end"},ne={__name:"DialogModal",props:{show:{type:Boolean,default:!1},maxWidth:{type:String,default:"2xl"},closeable:{type:Boolean,default:!0}},emits:["close"],setup(s,{emit:e}){const t=e,i=()=>{t("close")};return(n,h)=>(F(),j(Q,{show:s.show,"max-width":s.maxWidth,closeable:s.closeable,onClose:i},{default:I(()=>[b("div",Y,[b("div",ee,[C(n.$slots,"title")]),b("div",te,[C(n.$slots,"content")])]),b("div",ie,[C(n.$slots,"footer")])]),_:3},8,["show","max-width","closeable"]))}};/**
 * Vue Currency Input 3.2.1
 * (c) 2018-2025 Matthias Stiller
 * @license MIT
 */var $;(function(s){s.symbol="symbol",s.narrowSymbol="narrowSymbol",s.code="code",s.name="name",s.hidden="hidden"})($||($={}));var _;(function(s){s.precision="precision",s.thousands="thousands",s.tenThousands="tenThousands",s.millions="millions",s.billions="billions"})(_||(_={}));const k=s=>s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),W=s=>s.replace(/^0+(0$|[^0])/,"$1"),O=(s,e)=>(s.match(new RegExp(k(e),"g"))||[]).length,se=(s,e)=>s.substring(0,s.indexOf(e)),B=[",",".","٫","。"],L="(0|[1-9]\\d*)";class oe{constructor(e){var t,i,n,h,m,p;const{currency:g,currencyDisplay:f,locale:l,precision:u,accountingSign:c,useGrouping:r}=e;this.locale=l,this.options={currency:g,useGrouping:r,style:"currency",currencySign:c?"accounting":void 0,currencyDisplay:f!==$.hidden?f:void 0};const o=new Intl.NumberFormat(l,this.options),y=o.formatToParts(123456);this.currency=(t=y.find(({type:a})=>a==="currency"))===null||t===void 0?void 0:t.value,this.digits=[0,1,2,3,4,5,6,7,8,9].map(a=>a.toLocaleString(l)),this.decimalSymbol=(i=y.find(({type:a})=>a==="decimal"))===null||i===void 0?void 0:i.value,this.groupingSymbol=(n=y.find(({type:a})=>a==="group"))===null||n===void 0?void 0:n.value,this.minusSign=(h=o.formatToParts(-1).find(({type:a})=>a==="minusSign"))===null||h===void 0?void 0:h.value,this.decimalSymbol===void 0?this.minimumFractionDigits=this.maximumFractionDigits=0:typeof u=="number"?this.minimumFractionDigits=this.maximumFractionDigits=u:(this.minimumFractionDigits=(m=u==null?void 0:u.min)!==null&&m!==void 0?m:o.resolvedOptions().minimumFractionDigits,this.maximumFractionDigits=(p=u==null?void 0:u.max)!==null&&p!==void 0?p:o.resolvedOptions().maximumFractionDigits);const d=a=>se(a,this.digits[1]),x=a=>a.substring(a.lastIndexOf(this.decimalSymbol?this.digits[0]:this.digits[1])+1);this.prefix=d(o.format(1)),this.suffix=x(o.format(1)),this.negativePrefix=d(o.format(-1)),this.negativeSuffix=x(o.format(-1))}parse(e){if(e){const t=this.isNegative(e);e=this.normalizeDigits(e),e=this.stripCurrency(e,t),e=this.stripSignLiterals(e);const i=this.decimalSymbol?`(?:${k(this.decimalSymbol)}(\\d*))?`:"",n=this.stripGroupingSeparator(e).match(new RegExp(`^${L}${i}$`));if(n&&this.isValidIntegerFormat(this.decimalSymbol?e.split(this.decimalSymbol)[0]:e,Number(n[1])))return+`${t?"-":""}${this.onlyDigits(n[1])}.${this.onlyDigits(n[2]||"")}`}return null}isValidIntegerFormat(e,t){const i={...this.options,minimumFractionDigits:0};return[this.stripCurrency(this.normalizeDigits(t.toLocaleString(this.locale,{...i,useGrouping:!0})),!1),this.stripCurrency(this.normalizeDigits(t.toLocaleString(this.locale,{...i,useGrouping:!1})),!1)].includes(e)}format(e,t={minimumFractionDigits:this.minimumFractionDigits,maximumFractionDigits:this.maximumFractionDigits}){return e!=null?e.toLocaleString(this.locale,{...this.options,...t}):""}toFraction(e){return`${this.digits[0]}${this.decimalSymbol}${this.onlyLocaleDigits(e.substring(1)).substring(0,this.maximumFractionDigits)}`}isFractionIncomplete(e){return!!this.normalizeDigits(this.stripGroupingSeparator(e)).match(new RegExp(`^${L}${k(this.decimalSymbol)}$`))}isNegative(e){return e.startsWith(this.negativePrefix)||this.minusSign===void 0&&(e.startsWith("(")||e.startsWith("-"))||this.minusSign!==void 0&&e.replace("-",this.minusSign).startsWith(this.minusSign)}insertCurrency(e,t){return`${t?this.negativePrefix:this.prefix}${e}${t?this.negativeSuffix:this.suffix}`}stripGroupingSeparator(e){return this.groupingSymbol!==void 0?e.replace(new RegExp(k(this.groupingSymbol),"g"),""):e}stripSignLiterals(e){return this.minusSign!==void 0?e.replace("-",this.minusSign).replace(this.minusSign,""):e.replace(/[-()]/g,"")}stripCurrency(e,t){return e.replace(t?this.negativePrefix:this.prefix,"").replace(t?this.negativeSuffix:this.suffix,"")}normalizeDecimalSeparator(e,t){return B.forEach(i=>{e=e.substring(0,t)+e.substring(t).replace(i,this.decimalSymbol)}),e}normalizeDigits(e){return this.digits[0]!=="0"&&this.digits.forEach((t,i)=>{e=e.replace(new RegExp(t,"g"),String(i))}),e}onlyDigits(e){return this.normalizeDigits(e).replace(/\D+/g,"")}onlyLocaleDigits(e){return e.replace(new RegExp(`[^${this.digits.join("")}]*`,"g"),"")}}class q{constructor(e){this.currencyFormat=e}}class re extends q{conformToMask(e,t=""){const i=this.currencyFormat.isNegative(e),n=o=>o===""&&i&&!(this.currencyFormat.minusSign===void 0?t===this.currencyFormat.negativePrefix+this.currencyFormat.negativeSuffix:t===this.currencyFormat.negativePrefix),h=o=>{if(n(o))return"";if(this.currencyFormat.maximumFractionDigits>0){if(this.currencyFormat.isFractionIncomplete(o))return o;if(o.startsWith(this.currencyFormat.decimalSymbol))return this.currencyFormat.toFraction(o)}return null};let m=e;m=this.currencyFormat.stripCurrency(m,i),m=this.currencyFormat.stripSignLiterals(m);const p=h(m);if(p!=null)return this.currencyFormat.insertCurrency(p,i);const[g,...f]=m.split(this.currencyFormat.decimalSymbol),l=W(this.currencyFormat.onlyDigits(g)),u=this.currencyFormat.onlyDigits(f.join("")).substring(0,this.currencyFormat.maximumFractionDigits),c=f.length>0&&u.length===0,r=l===""&&i&&(this.currencyFormat.minusSign===void 0?t===e.slice(0,-2)+this.currencyFormat.negativeSuffix:t===e.slice(0,-1));return c||r||n(l)?t:l.match(/\d+/)?{numberValue:+`${i?"-":""}${l}.${u}`,fractionDigits:u}:""}}class ae extends q{conformToMask(e,t=""){if(e===""||this.currencyFormat.parse(t)===0&&this.currencyFormat.stripCurrency(t,!0).slice(0,-1)===this.currencyFormat.stripCurrency(e,!0))return"";const i=this.currencyFormat.isNegative(e),n=this.currencyFormat.stripSignLiterals(e)===""?-0:+`${i?"-":""}${W(this.currencyFormat.onlyDigits(e))}`/Math.pow(10,this.currencyFormat.maximumFractionDigits);return{numberValue:n,fractionDigits:n.toFixed(this.currencyFormat.maximumFractionDigits).slice(-this.currencyFormat.maximumFractionDigits)}}}const le={locale:void 0,currency:void 0,currencyDisplay:void 0,hideGroupingSeparatorOnFocus:!0,hideCurrencySymbolOnFocus:!0,hideNegligibleDecimalDigitsOnFocus:!0,precision:void 0,autoDecimalDigits:!1,valueRange:void 0,useGrouping:void 0,valueScaling:void 0};class ue{constructor(e){this.el=e.el,this.onInput=e.onInput,this.onChange=e.onChange,this.addEventListener(),this.init(e.options)}setOptions(e){this.init(e),this.format(this.currencyFormat.format(this.validateValueRange(this.numberValue))),this.onChange(this.getValue())}getValue(){return{number:this.valueScaling&&this.numberValue!=null?this.toInteger(this.numberValue,this.valueScaling):this.numberValue,formatted:this.formattedValue}}setValue(e){const t=this.valueScaling!==void 0&&e!=null?this.toFloat(e,this.valueScaling):e;t!==this.numberValue&&(this.format(this.currencyFormat.format(this.validateValueRange(t))),this.onChange(this.getValue()))}init(e){this.options={...le,...e},this.options.autoDecimalDigits&&(this.options.hideNegligibleDecimalDigitsOnFocus=!1),this.el.getAttribute("inputmode")||this.el.setAttribute("inputmode",this.options.autoDecimalDigits?"numeric":"decimal"),this.currencyFormat=new oe(this.options),this.numberMask=this.options.autoDecimalDigits?new ae(this.currencyFormat):new re(this.currencyFormat);const t={[_.precision]:this.currencyFormat.maximumFractionDigits,[_.thousands]:3,[_.tenThousands]:4,[_.millions]:6,[_.billions]:9};this.valueScaling=this.options.valueScaling?t[this.options.valueScaling]:void 0,this.valueScalingFractionDigits=this.valueScaling!==void 0&&this.options.valueScaling!==_.precision?this.valueScaling+this.currencyFormat.maximumFractionDigits:this.currencyFormat.maximumFractionDigits,this.minValue=this.getMinValue(),this.maxValue=this.getMaxValue()}getMinValue(){var e,t;let i=this.toFloat(-Number.MAX_SAFE_INTEGER);return((e=this.options.valueRange)===null||e===void 0?void 0:e.min)!==void 0&&(i=Math.max((t=this.options.valueRange)===null||t===void 0?void 0:t.min,this.toFloat(-Number.MAX_SAFE_INTEGER))),i}getMaxValue(){var e,t;let i=this.toFloat(Number.MAX_SAFE_INTEGER);return((e=this.options.valueRange)===null||e===void 0?void 0:e.max)!==void 0&&(i=Math.min((t=this.options.valueRange)===null||t===void 0?void 0:t.max,this.toFloat(Number.MAX_SAFE_INTEGER))),i}toFloat(e,t){return e/Math.pow(10,t??this.valueScalingFractionDigits)}toInteger(e,t){return Number(e.toFixed(t??this.valueScalingFractionDigits).split(".").join(""))}validateValueRange(e){return e!=null?Math.min(Math.max(e,this.minValue),this.maxValue):e}format(e,t=!1){if(e!=null){this.decimalSymbolInsertedAt!==void 0&&(e=this.currencyFormat.normalizeDecimalSeparator(e,this.decimalSymbolInsertedAt),this.decimalSymbolInsertedAt=void 0);const i=this.numberMask.conformToMask(e,this.formattedValue);let n;if(typeof i=="object"){const{numberValue:h,fractionDigits:m}=i;let{maximumFractionDigits:p,minimumFractionDigits:g}=this.currencyFormat;this.focus?g=t?m.replace(/0+$/,"").length:Math.min(p,m.length):Number.isInteger(h)&&!this.options.autoDecimalDigits&&(this.options.precision===void 0||g===0)&&(g=p=0),n=this.toInteger(Math.abs(h))>Number.MAX_SAFE_INTEGER?this.formattedValue:this.currencyFormat.format(h,{useGrouping:this.options.useGrouping!==!1&&!(this.focus&&this.options.hideGroupingSeparatorOnFocus),minimumFractionDigits:g,maximumFractionDigits:p})}else n=i;this.maxValue<=0&&!this.currencyFormat.isNegative(n)&&this.currencyFormat.parse(n)!==0&&(n=n.replace(this.currencyFormat.prefix,this.currencyFormat.negativePrefix)),this.minValue>=0&&(n=n.replace(this.currencyFormat.negativePrefix,this.currencyFormat.prefix)),(this.options.currencyDisplay===$.hidden||this.focus&&this.options.hideCurrencySymbolOnFocus)&&(n=n.replace(this.currencyFormat.negativePrefix,this.currencyFormat.minusSign!==void 0?this.currencyFormat.minusSign:"(").replace(this.currencyFormat.negativeSuffix,this.currencyFormat.minusSign!==void 0?"":")").replace(this.currencyFormat.prefix,"").replace(this.currencyFormat.suffix,"")),this.el.value=n,this.numberValue=this.currencyFormat.parse(n)}else this.el.value="",this.numberValue=null;this.formattedValue=this.el.value,this.onInput(this.getValue())}addEventListener(){this.el.addEventListener("input",e=>{const{value:t,selectionStart:i}=this.el,n=e;if(i&&n.data&&B.includes(n.data)&&(this.decimalSymbolInsertedAt=i-1),this.format(t),this.focus&&i!=null){const h=()=>{const{prefix:m,suffix:p,decimalSymbol:g,maximumFractionDigits:f,groupingSymbol:l}=this.currencyFormat;let u=t.length-i;const c=this.formattedValue.length;if(this.currencyFormat.minusSign===void 0&&(t.startsWith("(")||t.startsWith("-"))&&!t.endsWith(")"))return c-this.currencyFormat.negativeSuffix.length>1?this.formattedValue.substring(i).length:1;if(this.formattedValue.substring(i,1)===l&&O(this.formattedValue,l)===O(t,l)+1)return c-u-1;if(c<u)return i;if(g!==void 0&&t.indexOf(g)!==-1){const r=t.indexOf(g)+1;if(Math.abs(c-t.length)>1&&i<=r)return this.formattedValue.indexOf(g)+1;!this.options.autoDecimalDigits&&i>r&&this.currencyFormat.onlyDigits(t.substring(r)).length-1===f&&(u-=1)}return this.options.hideCurrencySymbolOnFocus||this.options.currencyDisplay===$.hidden?c-u:Math.max(c-Math.max(u,p.length),m.length)};this.setCaretPosition(h())}}),this.el.addEventListener("focus",()=>{this.focus=!0,this.numberValueOnFocus=this.numberValue,setTimeout(()=>{const{value:e,selectionStart:t,selectionEnd:i}=this.el;if(this.format(e,this.options.hideNegligibleDecimalDigitsOnFocus),t!=null&&i!=null&&Math.abs(t-i)>0)this.setCaretPosition(0,this.el.value.length);else if(t!=null){const n=this.getCaretPositionOnFocus(e,t);this.setCaretPosition(n)}})}),this.el.addEventListener("blur",()=>{this.focus=!1,this.format(this.currencyFormat.format(this.validateValueRange(this.numberValue))),this.numberValueOnFocus!==this.numberValue&&this.onChange(this.getValue())})}getCaretPositionOnFocus(e,t){if(this.numberValue==null)return t;const{prefix:i,negativePrefix:n,suffix:h,negativeSuffix:m,groupingSymbol:p,currency:g}=this.currencyFormat,f=this.numberValue<0,l=f?n:i,u=l.length;if(this.options.hideCurrencySymbolOnFocus||this.options.currencyDisplay===$.hidden){if(f){if(t<=1)return 1;if(e.endsWith(")")&&t>e.indexOf(")"))return this.formattedValue.length-1}}else{const r=f?m.length:h.length;if(t>=e.length-r)return this.formattedValue.length-r;if(t<u)return u}let c=t;return this.options.hideCurrencySymbolOnFocus&&this.options.currencyDisplay!==$.hidden&&t>=u&&g!==void 0&&l.includes(g)&&(c-=u,f&&(c+=1)),this.options.hideGroupingSeparatorOnFocus&&p!==void 0&&(c-=O(e.substring(0,t),p)),c}setCaretPosition(e,t=e){this.el.setSelectionRange(e,t)}}const ce=s=>s!=null&&s.matches("input")?s:s==null?void 0:s.querySelector("input");function me(s,e){var t,i,n,h;let m;const p=N(null),g=N(null),f=N(null),l=X(),u=(l==null?void 0:l.emit)||((i=(t=l==null?void 0:l.proxy)===null||t===void 0?void 0:t.$emit)===null||i===void 0?void 0:i.bind(l==null?void 0:l.proxy)),c=(l==null?void 0:l.props)||((n=l==null?void 0:l.proxy)===null||n===void 0?void 0:n.$props),r=J.startsWith("3"),o=r&&((h=l==null?void 0:l.attrs.modelModifiers)===null||h===void 0?void 0:h.lazy),y=G(()=>c==null?void 0:c[r?"modelValue":"value"]),d=r?"update:modelValue":"input",x=o?"update:modelValue":"change";return z(p,a=>{var M;if(a){const P=ce((M=a==null?void 0:a.$el)!==null&&M!==void 0?M:a);P?(m=new ue({el:P,options:s,onInput:E=>{!o&&e!==!1&&y.value!==E.number&&(u==null||u(d,E.number)),f.value=E.number,g.value=E.formatted},onChange:E=>{u==null||u(x,E.number)}}),m.setValue(y.value)):console.error('No input element found. Please make sure that the "inputRef" template ref is properly assigned.')}else m=null}),{inputRef:p,numberValue:f,formattedValue:g,setValue:a=>m==null?void 0:m.setValue(a),setOptions:a=>m==null?void 0:m.setOptions(a)}}const de={class:"relative z-0 w-72"},he=["disabled"],ge=["for"],U={__name:"BidInput",props:{modelValue:[String,Number],disabled:Boolean,label:String,id:String,options:{type:Object,default:{currency:"USD"}}},setup(s){const e=s,{inputRef:t}=me(e.options);return(i,n)=>(F(),D("div",de,[b("input",{class:Z(["peer block appearance-none w-full bg-light-primary text-light-quatrenary border-6 ps-2 pt-3 pb-0 border-rose-500 ring-1 ring-light-quatrenary focus:outline-1 focus:text-accent focus:ring-accent focus:ring-2",{"bg-light-secondary border-4":e.disabled}]),disabled:e.disabled,ref_key:"inputRef",ref:t},null,10,he),b("label",{for:e.id,class:"absolute opacity-50 peer-focus:opacity-100 text-xs text-light-quatrenary left-1 duration-200 transform -translate-y-3.5 scale-75 top-4 origin-[0] peer-focus:start-0.5 peer-focus:font-bold peer-placeholder-shown:scale-100 peer-placeholder-shown:-translate-y-3 peer-focus:scale-75 peer-focus:-translate-y-4 peer-focus:z-50 peer-focus:text-black rtl:peer-focus:translate-x-1/4 rtl:peer-focus:left-auto"},R(e.label),9,ge)]))}},pe=["onClick"],fe=["onClick"],ye=["onClick"],xe={__name:"BidModal",props:{show:Boolean,job:Object,new:Boolean},emits:["closeModal"],setup(s,{emit:e}){const t=s,i=H({id:0,number:0,state:"",city:"",address:"",sections:[],total:0}),n=G({get(){return t.show},set(c){m("closeModal",c)}});z(n,()=>{t.new?g():(i.id=t.job.id,i.number=t.job.number,i.state=t.job.state,i.city=t.job.city,i.address=t.job.address,i.sections=t.job.sections,i.sections.forEach((c,r)=>{c.lines.forEach((o,y)=>{var d;o.uom=(d=t.job.sections[r].lines[y].unit_of_measurement)==null?void 0:d.UOM,h(r,y)}),c.lines.length||(c.lines.push({...f}),c.lines[0].uom="")}))});const h=(c,r)=>{let o=i.sections[c].lines[r];o.total=o.price*o.quantity},m=e,p=()=>{i.post("/",{onSuccess:()=>{i.reset()}})},g=()=>{i.sections.push({...l}),i.sections[i.sections.length-1].lines=[{...f}]};let f={id:0,description:"",uom:"",price:0,quantity:0,metadata:{}},l={id:0,name:"",area:0,lines:[]};const u=()=>{n.value=!1};return(c,r)=>(F(),j(ne,{show:t.show,onClose:r[5]||(r[5]=o=>u()),maxWidth:"6xl"},{header:I(()=>r[6]||(r[6]=[])),content:I(()=>[b("h1",null,R(s.job.job_number),1),b("form",{class:"flex flex-col w-full gap-4",onSubmit:r[4]||(r[4]=w(o=>p(),["prevent"]))},[b("div",null,[r[7]||(r[7]=b("h2",null,"Job Site",-1)),b("div",null,[v(V,{modelValue:S(i).address,"onUpdate:modelValue":r[0]||(r[0]=o=>S(i).address=o)},null,8,["modelValue"])]),b("div",null,[v(V,{modelValue:S(i).city,"onUpdate:modelValue":r[1]||(r[1]=o=>S(i).city=o)},null,8,["modelValue"])]),b("div",null,[v(V,{modelValue:S(i).state,"onUpdate:modelValue":r[2]||(r[2]=o=>S(i).state=o)},null,8,["modelValue"])])]),K(" "+R(t.job)+" ",1),(F(!0),D(A,null,T(S(i).sections,(o,y)=>(F(),D("div",{key:y},[v(V,{type:"hidden",modelValue:o.id,"onUpdate:modelValue":d=>o.id=d},null,8,["modelValue","onUpdate:modelValue"]),v(V,{modelValue:o.name,"onUpdate:modelValue":d=>o.name=d},null,8,["modelValue","onUpdate:modelValue"]),v(V,{modelValue:o.area,"onUpdate:modelValue":d=>o.area=d,onfocus:"this.select()"},null,8,["modelValue","onUpdate:modelValue"]),y?(F(),D("button",{key:1,class:"py-2 px-4 rounded-md bg-light-primary dark:bg-dark-primary",onClick:w(d=>S(i).sections.splice(y,1),["prevent"])},"REMOVE SECTION",8,pe)):(F(),D("button",{key:0,class:"py-2 px-4 rounded-md bg-light-primary dark:bg-dark-primary",onClick:r[3]||(r[3]=w(d=>g(),["prevent"]))},"ADD SECTION")),(F(!0),D(A,null,T(o.lines,(d,x)=>(F(),D("div",{key:x,class:"flex"},[v(V,{type:"hidden",modelValue:d.id,"onUpdate:modelValue":a=>d.id=a},null,8,["modelValue","onUpdate:modelValue"]),v(V,{class:"grow",modelValue:d.description,"onUpdate:modelValue":a=>d.description=a},null,8,["modelValue","onUpdate:modelValue"]),v(V,{modelValue:d.uom,"onUpdate:modelValue":a=>d.uom=a},null,8,["modelValue","onUpdate:modelValue"]),v(U,{modelValue:d.price,"onUpdate:modelValue":a=>d.price=a,onInput:a=>h(y,x),onfocus:"this.select()"},null,8,["modelValue","onUpdate:modelValue","onInput"]),v(V,{modelValue:d.quantity,"onUpdate:modelValue":a=>d.quantity=a,onInput:a=>h(y,x),onfocus:"this.select()"},null,8,["modelValue","onUpdate:modelValue","onInput"]),v(U,{value:c.$filters.formatCurrency(d.price*d.quantity)},null,8,["value"]),x?(F(),D("button",{key:1,class:"py-1 px-4 rounded-md bg-light-secondary dark:bg-dark-secondary",onClick:w(a=>o.lines.splice(x,1),["prevent"])},"-",8,ye)):(F(),D("button",{key:0,class:"py-1 px-4 rounded-md bg-light-secondary dark:bg-dark-secondary",onClick:w(a=>o.lines.push({...S(f)}),["prevent"])},"+",8,fe))]))),128))]))),128))],32)]),footer:I(()=>r[8]||(r[8]=[])),_:1},8,["show"]))}};export{xe as default};
