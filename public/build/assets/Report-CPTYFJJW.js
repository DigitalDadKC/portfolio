import{g as R,s as j,i as m,j as q,o as w,w as a,a as e,b,h as z,d as n,k as y,c as x,F as k,r as B,t as g}from"./app-B36-XCD0.js";import{_ as G}from"./EstimatingLayout-D_4DmskC.js";import{C as H,p as I,a as K,b as Q,B as W,c as X,L as Z,P as ee,d as te,e as ae,f as le}from"./index-DET9q5xs.js";import"./NavLink-BrQt31dZ.js";import"./GuestLayout-C970xYKx.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const oe={class:"d-flex justify-center"},se={class:"d-flex justify-center"},ne={class:"p-4"},re={class:"d-flex justify-space-between"},de={class:"p-4"},ue={class:"d-flex justify-space-between"},ie={class:"p-4"},ce={class:"d-flex justify-space-between"},ge={__name:"Report",props:{jobs:Object},setup(L){H.register(I,K,Q,W,X,Z,ee,te);const M=L,_=[...new Set(M.jobs.map(o=>new Date(o.created_at).getUTCFullYear()))].sort(),f=[{id:1,month:"January"},{id:2,month:"February"},{id:3,month:"March"},{id:4,month:"April"},{id:5,month:"May"},{id:6,month:"June"},{id:7,month:"July"},{id:8,month:"August"},{id:9,month:"September"},{id:10,month:"October"},{id:11,month:"November"},{id:12,month:"December"}],C=["#29435C","#925a2b","#556E53"];let D=[],V=[],E=[];_.forEach((o,t)=>{let i=[],v=[],h=[],p=M.jobs.filter(c=>new Date(c.created_at).getUTCFullYear()==o);f.forEach((c,u)=>{i.push(p.filter(l=>new Date(l.created_at).getMonth()==u).length),v.push(p.filter(l=>new Date(l.created_at).getMonth()==u).map(l=>l.proposals.reduce((s,r)=>s+r.scopes.reduce((Y,T)=>Y+T.lines.reduce(($,P)=>$+P.price/100*(P.quantity/100),0),0),0))),h.push(p.filter(l=>new Date(l.created_at).getMonth()==u).map(l=>l.proposals).map(l=>l.length).reduce((l,s)=>l+s,0))}),D.push({label:o,backgroundColor:C[t],borderColor:C[t],data:i}),V.push({label:o,backgroundColor:C[t],borderColor:C[t],data:v.map(c=>c.reduce((u,l)=>u+l,0))}),E.push(h)});const F={labels:f.map(o=>o.month),datasets:D},J={labels:f.map(o=>o.month),datasets:V},d=R(Math.max(..._)),O=j(()=>D.find(o=>o.label==d.value)),S=j(()=>E[_.indexOf(d.value)]),U=j(()=>V.find(o=>o.label==d.value).data),A={responsive:!0,plugins:{title:{display:!0,text:"Annual Job Count"}}},N={responsive:!0,plugins:{title:{display:!0,text:"Annual Proposal $"}}};return(o,t)=>{const i=m("v-col"),v=m("v-row"),h=m("v-card-title"),p=m("v-select"),c=m("v-card-item"),u=m("v-card"),l=m("v-container");return w(),q(G,null,{default:a(()=>[e(b(z),{title:"Reporting"}),e(l,{class:"w-100 w-xl-75 bg-grey-lighten-2 rounded-lg"},{default:a(()=>[e(v,null,{default:a(()=>[e(i,{cols:"12",lg:"6"},{default:a(()=>[n("div",oe,[e(b(ae),{id:"bar-chart",options:A,data:F,"aria-label":"Bar Chart Data","aria-describedby":"bar-chart",class:"bg-light-secondary rounded-md w-full h-full"},{default:a(()=>t[3]||(t[3]=[y("Chart could not be loaded",-1)])),_:1,__:[3]})])]),_:1}),e(i,{cols:"12",lg:"6"},{default:a(()=>[n("div",se,[e(b(le),{id:"line-chart",options:N,data:J,"aria-label":"Line Chart Data","aria-describedby":"line-chart",class:"bg-light-tertiary w-full h-full"},{default:a(()=>t[4]||(t[4]=[y("Chart could not be loaded",-1)])),_:1,__:[4]})])]),_:1})]),_:1}),e(v,null,{default:a(()=>[e(i,{cols:"12",lg:"6"},{default:a(()=>[e(u,null,{default:a(()=>[n("div",ne,[e(h,{class:"text-center"},{default:a(()=>t[5]||(t[5]=[y("Job Count",-1)])),_:1,__:[5]}),e(p,{modelValue:d.value,"onUpdate:modelValue":t[0]||(t[0]=s=>d.value=s),items:b(_),"hide-details":"",class:"bg-grey-lighten-2"},null,8,["modelValue","items"])]),(w(),x(k,null,B(f,(s,r)=>e(c,{key:r},{default:a(()=>[n("div",re,[n("div",null,g(s.month),1),n("div",null,g(O.value.data[r]),1)])]),_:2},1024)),64))]),_:1})]),_:1}),e(i,{cols:"12",lg:"3"},{default:a(()=>[e(u,null,{default:a(()=>[n("div",de,[e(h,{class:"text-center"},{default:a(()=>t[6]||(t[6]=[y("Proposal Count",-1)])),_:1,__:[6]}),e(p,{modelValue:d.value,"onUpdate:modelValue":t[1]||(t[1]=s=>d.value=s),items:b(_),"hide-details":"",class:"bg-grey-lighten-2"},null,8,["modelValue","items"])]),(w(),x(k,null,B(f,(s,r)=>e(c,{key:r},{default:a(()=>[n("div",ue,[n("div",null,g(s.month),1),n("div",null,g(S.value[r]),1)])]),_:2},1024)),64))]),_:1})]),_:1}),e(i,{cols:"12",lg:"3"},{default:a(()=>[e(u,null,{default:a(()=>[n("div",ie,[e(h,{class:"text-center"},{default:a(()=>t[7]||(t[7]=[y("Proposal Volume",-1)])),_:1,__:[7]}),e(p,{modelValue:d.value,"onUpdate:modelValue":t[2]||(t[2]=s=>d.value=s),items:b(_),"hide-details":"",class:"bg-grey-lighten-2"},null,8,["modelValue","items"])]),(w(),x(k,null,B(f,(s,r)=>e(c,{key:r},{default:a(()=>[n("div",ce,[n("div",null,g(s.month),1),n("div",null,g(o.$filters.formatCurrency(U.value[r])),1)])]),_:2},1024)),64))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}};export{ge as default};
